const Algorithmia = require('algorithmia')
const express = require('express')
const app = express()
const path = require('path')
const morgan = require('morgan')
// const routes = require('./routes')
const cors = require('cors')
const extractFrames = require('ffmpeg-extract-frames')
const validate = {}

app.use(cors())
app.use(express.json())
app.use(express.urlencoded({ extended: true}))
app.use(morgan("dev"))
app.use('/files', 
express.static(path.resolve(__dirname)))
// app.use(routes)
app.get('/', function(req, res) {
  res.send('hello world');
});
routes.post("/posts", multer(multerConfig).single("file"),()=>{})

app.listen(3001)
getImage(1000)
// getImgInfo()

validate.video = './GH010414.MP4'


async function getImage(moment){
  await extractFrames({
    input: './GH010413.MP4',
    output: './screenshot.jpg',
    offsets: [
      moment
    ],
  })
  // validate.img = './screenshot-%i.jpg'
  validate.img = 'http://localhost:3001/files/screenshot.jpg'
  getImgInfo()
}
async function getImgInfo(){
  await Algorithmia("simNlkTxJYHeQKzDiRvn5fS+PNC1")
    .algo("LgoBE/CarMakeandModelDetection/1.1.0")
    .pipe('data:image/jpeg;base64,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')
    .then(function(output) { 
      // validate.make = output.result[0][0].make
      // validate.model = output.result[0][0].model
      // console.log(validate.make, validate.model)
      console.log(output)
    })
  }